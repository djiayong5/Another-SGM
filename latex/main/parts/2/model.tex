\section{Структура модели}
\label{model}
Диаграммы состояний \emph{UML} могут содержать довольно много различных элементов. Это, с 
одной стороны, помогает описывать логику поведения более компактным образом, 
но, с другой стороны, затрудняет описание семантики. В этом разделе будут
выделены основные элементы диаграмм состояний, которые используются в настоящей работе.
В разделе~\ref{another_elements} приведено несколько примеров реализации
других элементов диаграмм состояний \emph{UML}, с помощью модели,
описанной в этом разделе.

Перейдем к описанию основных элементов диаграмм состояний, которые применяются в создаваемой модели. 

\subsection{События}
Из всех типов событий, представленных в языке \emph{UML}, в предлагаемой модели сохранится только 
один тип --- сигналы. Все остальные типы могут быть промоделированы с использованием сигналов.
Будем разделять события (сигналы) на внешние и внутренние. Внутренние события
посылаются системой самой себе в процессе обработки другого события. Все остальные события --- внешние.

\subsection{Состояния}
В рассматриваемой модели сохранены только основные типы состояний, используемые в диаграммах состояний \emph{UML}. 
Далее в разделе~\ref{another_elements} будет показано, как в рамках предлагаемой модели реализовать
различные псевдосостояния, представленные в \emph{UML}.

\subsubsection{Простое состояние}
Простое состояние изображается в виде прямоугольника со скругленными краями, внутри которого 
написано название состояния. 

Например, состояние <<\t{Ожидание}>> изображено на рис.~\ref{simple_state}

        \begin{figure}[htb]
        \centerline{ \includegraphics{pic/states.1}}
        \caption{Простое состояние}
        \label{simple_state}
        \end{figure}

\subsubsection{OR-состояние}
OR-состояние --- это состояние, представляющее группу из нескольких подсостояний.
Оно так же, как и простое состояние, изображается в виде прямоугольника со 
скругленными краями, внутри которого располагаются его подсостояния.

Например, составное состояние часов <<\t{Включены}>>, содержащее подсостояния 
<<\t{Время}>> и <<\t{Дата}>>, изображено на рис.~\ref{or-state}.

        \begin{figure}[htb]
        \centerline{ \includegraphics{pic/states.2}}
        \caption{OR-состояние}
        \label{or-state}
        \end{figure}

\subsubsection{AND-состояние}
AND-состояние --- это состояние, объединяющее несколько OR-состояний, 
отвечающих за деятельности, которые не зависят друг от друга. Оно изображается 
в виде прямоугольника со скругленными краями, разделенного на части пунктирными 
линиями. Различные части соответствуют OR-состояниям, объединенным этим AND-состоянием.
Например, совместное состояние часов <<\t{Включены}>>, объединяющее составные состояния 
<<\t{Изображение}>> и <<\t{СостояниеБудильника}>>, изображено на рис.~\ref{and-state}.

        \begin{figure}[htb]
        \centerline{ \includegraphics{pic/states.3}}
        \caption{AND-состояние}
        \label{and-state}
        \end{figure}

В предлагаемой модели будем считать, что есть состояние, содержащее все остальные состояния.
Будем называть его базовым состоянием. Если в исходной диаграмме состояний 
такого состояния нет, то его можно получить, добавив OR-состояние, содержащее 
все состояния исходной диаграммы.

\subsection{Дерево состояний}
Структура состояний естественно представляется в виде дерева, в корне которого находится 
базовое состояние, а в листьях --- простые состояния. Это дерево будем называть деревом
состояний. На рис.~\ref{states_tree} изображено дерево состояний для структуры, 
представленной на рис.~\ref{and-state}.

        \begin{figure}[htb]
        \centerline{ \includegraphics{pic/tree.1}}
        \caption{Дерево состояний}
        \label{states_tree}
        \end{figure}

\subsection{Активные состояния. Дерево активных состояний}
В каждый момент времени некоторые состояния являются активными. При этом соблюдаются 
следующие условия:

\begin{itemize}
\item базовое состояние активно;
\item eсли OR-состояние активно, то активно ровно его подсостояний, иначе 
все его подсостояния неактивны;
\item если AND-состояние активно, то активны все OR-состояния, объединенные
им, иначе все они неактивны.
\end{itemize}

Таким образом, активные состояния также могут быть естественно представлены в виде дерева,
в корне которого находится базовое состояние, а в листьях --- простые состояния. Это дерево 
будем называть деревом активных состояний. Такое дерево как граф является 
подграфом дерева состояний. Кроме того отметим, что все множество активных состояний 
однозначно задается множеством активных простых состояний. Поэтому состояние системы 
иногда будет задаваться перечислением активных простых состояний. 


\subsection{Переходы}
Переходы определяют правила изменения дерева активных состояний при появлении событий. 
Формально эти правила будут изложены в разделе~\ref{mysemantics}. В предлагаемой модели будет 
только один тип перехода --- простой переход.

Простой переход задается исходным состоянием, целевым состоянием, активирующим событием 
и защитным условием. Он изображается стрелкой от исходного к целевому состоянию.
Он помечается следующим образом: \t{<активирующие~событие>[\b{[}<защитное~условие>\b{]}]}.
Например, упрощенное описание поведения будильника может быть изображена как на 
рис.~\ref{simple_transitions}. По этой схеме переход активности от состояния <<\t{Тишина}>>
к состоянию <<\t{Звук}>> происходит при появлении события <<\t{пришлоВремя}>>, если в этот 
момент истинно значение переменной <<\t{будильникВключен}>>. Обратный переход выполняется при 
появлении события <<\t{нажатаКнопкаОтмены}>> независимо от значений переменной. 

        \begin{figure}[htb]
        \centerline{ \includegraphics{pic/transitions.1}}
        \caption{Простые переходы}
        \label{simple_transitions}
        \end{figure}

\subsection{Действия}
Действие --- это набор простых операций, выполнение которых занимает время, много меньшее
характерного времени системы. (В качестве характерного времени системы можно взять, 
например, среднюю величину интервала времени между событиями). Ограничение на 
время выполнения действия связано с тем, что при создании модели предполагается,
что обработкой события не могут заниматься несколько потоков одновременно. Если события будут 
приходить быстрее, чем будут успевать обрабатываться, возможен бесконечный рост очереди 
сообщений.

\subsubsection{Действия при входе и выходе}
Действие при входе в состояние --- это действие, совершаемое системой 
в момент, когда это состояние становится активным. Аналогично, действие при выходе из состояния, 
--- это действие, совершаемое системой в момент, когда это состояние перестает быть активным.

На схеме действия при входе и выходе обозначаются надписями: 
\mbox{\t{\b{entry/}<действие при входе>}} и \mbox{\t{\b{exit/}<действие при выходе>}} соответственно.

\subsubsection{Действие при переходе}
Действие при переходе --- это действие, которое выполняется при осуществлении перехода. 
Оно выполняется после действий при выходе и до действий при входе в состояние. Подробнее процесс 
выполнения перехода описан в разделе~\ref{mysemantics}.

На диаграмме действие при переходе обозначается добавлением к пометке перехода строки 
\t{\b{/}<действие при переходе>}.

